{"ast":null,"code":"import Qs from \"qs\";\nexport default {\n  name: \"Navigation\",\n\n  data() {\n    return {\n      isLogin: false,\n      loginName: '未命名用户',\n      activeIndex: '1',\n      activeIndex2: '1'\n    };\n  },\n\n  props: ['router'],\n  methods: {\n    selectUser() {\n      let parse = JSON.parse(localStorage.getItem('user'));\n      let user = {\n        name: parse.name,\n        password: parse.password\n      };\n      this.$axios.post('http://localhost:8080/user/selectUser', Qs.stringify(user)).then(response => {\n        this.$bus.$emit('user', response.data);\n      }, error => {\n        console.log(\"错误的原因是：\", error);\n      });\n    },\n\n    emitRouter(router) {\n      this.$bus.$emit('router', router);\n    },\n\n    emitLogin() {\n      this.$bus.$emit('router', '/login');\n    },\n\n    emitRegister() {\n      this.$bus.$emit('router', '/register');\n    },\n\n    emitUser() {\n      this.selectUser();\n    },\n\n    emitPublish() {\n      if (localStorage.getItem('user') === null) {\n        this.failed();\n      } else {\n        let user = {\n          name: JSON.parse(localStorage.getItem('user')).name,\n          userName: this.loginName\n        };\n        this.$bus.$emit('publish', user);\n      }\n    },\n\n    failed() {\n      this.$notify.error({\n        title: '失败',\n        message: '请先登录'\n      });\n    }\n\n  },\n\n  mounted() {\n    let user = JSON.parse(localStorage.getItem('user'));\n\n    if (user !== null && user.name !== '' && user.password !== '') {\n      this.isLogin = true;\n      this.$axios.post('http://localhost:8080/user/selectUser', Qs.stringify({\n        name: user.name,\n        pass: user.password\n      })).then(response => {\n        this.loginName = response.data.userName;\n\n        if (this.loginName === null) {\n          this.loginName = '未命名用户';\n        }\n      });\n    }\n  }\n\n};","map":{"version":3,"mappings":"AAmCA;AACA;EACAA,kBADA;;EAEAC;IACA;MACAC,cADA;MAEAC,kBAFA;MAGAC,gBAHA;MAIAC;IAJA;EAMA,CATA;;EAUAC,iBAVA;EAWAC;IACAC;MACA;MACA;QACAR,gBADA;QAEAS;MAFA;MAIA,mFACAC;QACA;MACA,CAHA,EAIAC;QACAC;MACA,CANA;IAQA,CAfA;;IAgBAC;MACA;IACA,CAlBA;;IAmBAC;MACA;IACA,CArBA;;IAsBAC;MACA;IACA,CAxBA;;IAyBAC;MACA;IACA,CA3BA;;IA4BAC;MACA;QACA;MACA,CAFA,MAEA;QACA;UACAjB,mDADA;UAEAkB;QAFA;QAIA;MACA;IACA,CAtCA;;IAuCAC;MACA;QACAC,WADA;QAEAC;MAFA;IAIA;;EA5CA,CAXA;;EAyDAC;IACA;;IACA;MACA;MAEA;QACAtB,eADA;QAEAuB;MAFA,IAGAC,IAHA,CAIAd;QACA;;QACA;UACA;QACA;MACA,CATA;IAWA;EACA;;AA1EA","names":["name","data","isLogin","loginName","activeIndex","activeIndex2","props","methods","selectUser","password","response","error","console","emitRouter","emitLogin","emitRegister","emitUser","emitPublish","userName","failed","title","message","mounted","pass","then"],"sourceRoot":"src/components","sources":["Navigation.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <el-row>\r\n      <el-col :span=\"21\">\r\n        <div class=\"grid-content bg-purple\">\r\n          <el-menu :default-active=\"activeIndex\" class=\"el-menu-demo\" mode=\"horizontal\">\r\n            <el-menu-item index=\"1\" @click=\"emitRouter('/home')\">首页</el-menu-item>\r\n            <el-menu-item index=\"2\" @click=\"emitRouter('/latest')\">最新</el-menu-item>\r\n            <el-menu-item index=\"3\">最热</el-menu-item>\r\n            <el-submenu index=\"4\">\r\n              <template slot=\"title\">更多</template>\r\n              <el-menu-item index=\"4-1\" @click=\"emitUser\">个人信息</el-menu-item>\r\n              <el-menu-item index=\"4-2\">会员服务</el-menu-item>\r\n              <el-menu-item index=\"4-3\">反馈/建议</el-menu-item>\r\n            </el-submenu>\r\n          </el-menu>\r\n        </div>\r\n        <el-button type=\"primary\" @click=\"emitPublish\">上传帖子<i class=\"el-icon-upload el-icon--right\"></i></el-button>\r\n      </el-col>\r\n      <el-col :span=\"3\">\r\n        <div class=\"grid-content bg-purple-light\">\r\n          <div v-show=\"!isLogin\">\r\n            <el-button type=\"primary\" round @click=\"emitLogin\">登录</el-button>\r\n            <el-button type=\"success\" round @click=\"emitRegister\">注册</el-button>\r\n          </div>\r\n          <div v-show=\"isLogin\">\r\n            <el-button type=\"danger\" round @click=\"emitUser\">{{loginName}}</el-button>\r\n          </div>\r\n        </div>\r\n      </el-col>\r\n    </el-row>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import Qs from \"qs\"\r\n  export default {\r\n    name: \"Navigation\",\r\n    data() {\r\n      return {\r\n        isLogin:false,\r\n        loginName:'未命名用户',\r\n        activeIndex: '1',\r\n        activeIndex2: '1',\r\n      };\r\n    },\r\n    props:['router'],\r\n    methods: {\r\n      selectUser(){\r\n        let parse = JSON.parse(localStorage.getItem('user'));\r\n        let user = {\r\n          name:parse.name,\r\n          password:parse.password\r\n        }\r\n        this.$axios.post('http://localhost:8080/user/selectUser',Qs.stringify(user)).then(\r\n            response => {\r\n              this.$bus.$emit('user',response.data)\r\n            },\r\n            error => {\r\n              console.log(\"错误的原因是：\",error)\r\n            }\r\n        )\r\n      },\r\n      emitRouter(router){\r\n        this.$bus.$emit('router',router)\r\n      },\r\n      emitLogin(){\r\n        this.$bus.$emit('router','/login')\r\n      },\r\n      emitRegister(){\r\n        this.$bus.$emit('router','/register')\r\n      },\r\n      emitUser(){\r\n        this.selectUser()\r\n      },\r\n      emitPublish(){\r\n        if (localStorage.getItem('user') === null){\r\n          this.failed()\r\n        }else {\r\n          let user = {\r\n            name:JSON.parse(localStorage.getItem('user')).name,\r\n            userName:this.loginName\r\n          }\r\n          this.$bus.$emit('publish',user)\r\n        }\r\n      },\r\n      failed() {\r\n        this.$notify.error({\r\n          title: '失败',\r\n          message: '请先登录',\r\n        });\r\n      },\r\n    },\r\n    mounted() {\r\n      let user = JSON.parse(localStorage.getItem('user'));\r\n      if (user !== null && user.name !== '' && user.password !== ''){\r\n        this.isLogin = true\r\n\r\n        this.$axios.post('http://localhost:8080/user/selectUser',Qs.stringify({\r\n          name:user.name,\r\n          pass:user.password\r\n        })).then(\r\n            response => {\r\n              this.loginName = response.data.userName\r\n              if (this.loginName === null){\r\n                this.loginName = '未命名用户'\r\n              }\r\n            },\r\n        )\r\n      }\r\n    },\r\n  }\r\n</script>\r\n\r\n<style scoped>\r\n  button{\r\n    margin-top: 20px;\r\n  }\r\n</style>"]},"metadata":{},"sourceType":"module"}